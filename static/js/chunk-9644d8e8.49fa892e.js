(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9644d8e8"],{"18a1":function(t,e,n){"use strict";var r=n("d0fe"),c=n.n(r);c.a},"50fc":function(t,e,n){"use strict";n.d(e,"A",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"M",(function(){return o})),n.d(e,"O",(function(){return a})),n.d(e,"o",(function(){return l})),n.d(e,"x",(function(){return i})),n.d(e,"t",(function(){return d})),n.d(e,"c",(function(){return s})),n.d(e,"C",(function(){return f})),n.d(e,"s",(function(){return h})),n.d(e,"h",(function(){return m})),n.d(e,"D",(function(){return b})),n.d(e,"E",(function(){return g})),n.d(e,"I",(function(){return p})),n.d(e,"k",(function(){return j})),n.d(e,"z",(function(){return O})),n.d(e,"d",(function(){return k})),n.d(e,"y",(function(){return R})),n.d(e,"j",(function(){return v})),n.d(e,"L",(function(){return C})),n.d(e,"n",(function(){return y})),n.d(e,"u",(function(){return w})),n.d(e,"w",(function(){return I})),n.d(e,"i",(function(){return _})),n.d(e,"F",(function(){return A})),n.d(e,"l",(function(){return B})),n.d(e,"g",(function(){return $})),n.d(e,"r",(function(){return x})),n.d(e,"N",(function(){return S})),n.d(e,"q",(function(){return E})),n.d(e,"p",(function(){return L})),n.d(e,"v",(function(){return F})),n.d(e,"G",(function(){return U})),n.d(e,"H",(function(){return J})),n.d(e,"K",(function(){return P})),n.d(e,"J",(function(){return W})),n.d(e,"B",(function(){return q})),n.d(e,"m",(function(){return z})),n.d(e,"a",(function(){return D})),n.d(e,"e",(function(){return G})),n.d(e,"f",(function(){return H}));var r=n("b775");function c(t){return console.log("api.js获取全部角色 params->",t),Object(r["a"])({url:"/role/list",method:"get",params:t})}function u(t){return Object(r["a"])({url:"/role/add",method:"post",data:t})}function o(t){return Object(r["a"])({url:"/role/update",method:"post",data:t})}function a(t){return Object(r["a"])({url:"role/updateStatus",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/role/delete/"+t,method:"post"})}function i(){return Object(r["a"])({url:"/resource/cate/list",method:"get"})}function d(){return Object(r["a"])({url:"/resource/list",method:"get"})}function s(t){return Object(r["a"])({url:"/role/allocResource",method:"post",data:t})}function f(t){return Object(r["a"])({url:"/resource/listByRole/"+t,method:"get"})}function h(t){return Object(r["a"])({url:"/admin/list",method:"get",params:t})}function m(t){return Object(r["a"])({url:"/admin/add",method:"post",data:t})}function b(t){return Object(r["a"])({url:"/admin/update",method:"post",data:t})}function g(t){return Object(r["a"])({url:"/admin/updateStatus",method:"post",data:t})}function p(t){return Object(r["a"])({url:"/admin/updatePassword",method:"post",data:t})}function j(t){return Object(r["a"])({url:"/admin/delete/"+t,method:"post"})}function O(t){return Object(r["a"])({url:"/role/listByAdmin/"+t,method:"get"})}function k(t){return Object(r["a"])({url:"/admin/allocRole",method:"post",data:t})}function R(t){return Object(r["a"])({url:"/resource/listWithPage",method:"get",params:t})}function v(t){return Object(r["a"])({url:"/resource/add",method:"post",data:t})}function C(t){return Object(r["a"])({url:"/resource/update",method:"post",data:t})}function y(t){return Object(r["a"])({url:"/resource/delete/"+t,method:"post"})}function w(){return Object(r["a"])({url:"/contest/cate/list",method:"get"})}function I(){return Object(r["a"])({url:"/contest/cate/parentList",method:"get"})}function _(t){return Object(r["a"])({url:"/contest/cate/add",method:"post",data:t})}function A(t){return Object(r["a"])({url:"/contest/cate/update",method:"post",data:t})}function B(t){return Object(r["a"])({url:"/contest/cate/delete/"+t,method:"post"})}function $(t){return Object(r["a"])({url:"/contest/check",method:"post",data:t})}function x(){return Object(r["a"])({url:"/",method:"get"})}function S(){return Object(r["a"])({url:"/",method:"get"})}function E(){return Object(r["a"])({url:"/",method:"get"})}function L(){return Object(r["a"])({url:"/contest/cate/listWithChildren",method:"get"})}function F(t){return Object(r["a"])({url:"/contest/list",method:"get",params:t})}function U(){return Object(r["a"])({url:"/",method:"get"})}function J(){return Object(r["a"])({url:"/",method:"get"})}function P(){return Object(r["a"])({url:"/",method:"get"})}function W(){return Object(r["a"])({url:"/",method:"get"})}function q(){return Object(r["a"])({url:"/recommend/listForAdmin",method:"get"})}function z(t){return Object(r["a"])({url:"/recommend/delete/"+t,method:"post"})}function D(t){return Object(r["a"])({url:"/recommend/add",method:"post",data:t})}function G(t){return Object(r["a"])({url:"/contest/batchCheck",method:"post",data:t})}function H(t){return Object(r["a"])({url:"/contest/cancel/"+t,method:"post"})}},bb71:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"form-container",attrs:{shadow:"never"}},[t._l(t.allResourceCate,(function(e,r){return n("div",{key:"cate"+e.id,class:0===r?"top-line":null,staticStyle:{width:"60%",margin:"0 auto"}},[n("el-row",{staticClass:"table-layout",staticStyle:{background:"#F2F6FC"}},[n("el-checkbox",{attrs:{indeterminate:t.isIndeterminate(e.id)},on:{change:function(n){return t.checkAll(e)}},model:{value:e.checked,callback:function(n){t.$set(e,"checked",n)},expression:"cate.checked"}},[t._v(t._s(e.name))])],1),t._v(" "),n("el-row",{staticClass:"table-layout"},t._l(t.getResourceByCate(e.id),(function(e){return n("el-col",{key:e.id,staticStyle:{padding:"4px 0"},attrs:{span:8}},[n("el-checkbox",{on:{change:function(n){return t.handleCheckChange(e)}},model:{value:e.checked,callback:function(n){t.$set(e,"checked",n)},expression:"resource.checked"}},[t._v(t._s(e.name))])],1)})),1)],1)})),t._v(" "),n("div",{staticStyle:{"margin-top":"20px"},attrs:{align:"center"}},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSave()}}},[t._v("确认")]),t._v(" "),n("el-button",{on:{click:function(e){return t.handleClear()}}},[t._v("清空")])],1)],2)},c=[],u=(n("1c4c"),n("5df3"),n("4f7f"),n("ac6a"),n("50fc")),o={name:"allocResource",data:function(){return{roleId:null,allResource:null,allResourceCate:null}},created:function(){this.roleId=this.$route.params.roleId,console.log("路由获得的roleId",this.roleId),this.getCate()},methods:{getAllResourceList:function(){var t=this;Object(u["t"])().then((function(e){t.allResource=e.data;for(var n=0;n<t.allResource.length;n++)t.allResource[n].checked=!1;t.getResourceByRole(t.roleId),console.log("getAllResourceList():",e.data)}))},getCate:function(){var t=this;Object(u["x"])().then((function(e){console.log("得到表头getResourceCateList",e.data),t.allResourceCate=e.data;for(var n=0;n<t.allResourceCate.length;n++)t.allResourceCate[n].checked=!1;t.getAllResourceList()}))},getResourceByCate:function(t){var e=[];if(null==this.allResource)return null;for(var n=0;n<this.allResource.length;n++){var r=this.allResource[n];r.parentId===t&&e.push(r)}return e},getResourceByRole:function(t){var e=this;Object(u["C"])(t).then((function(t){console.log("通过角色获得资源",t.data);var n=t.data;e.allResource.forEach((function(t){t.checked=e.getResourceChecked(t.id,n)})),e.allResourceCate.forEach((function(t){t.checked=e.isAllChecked(t.id)})),e.$forceUpdate()}))},getResourceChecked:function(t,e){if(null==e||0===e.length)return!1;for(var n=0;n<e.length;n++)if(e[n].id===t)return!0;return!1},isIndeterminate:function(t){var e=this.getResourceByCate(t);if(null==e)return!1;for(var n=0,r=0;r<e.length;r++)!0===e[r].checked&&n++;return!(0===n||n===e.length)},isAllChecked:function(t){var e=this.getResourceByCate(t);if(null==e)return!1;for(var n=0,r=0;r<e.length;r++)!0===e[r].checked&&n++;return 0!==n&&n===e.length},handleSave:function(){var t=this,e=new Set;null!=this.allResource&&this.allResource.length>0&&this.allResource.forEach((function(t){t.checked&&e.add(t.id)}));var n={id:this.roleId,ids:Array.from(e)};console.log("data->",n),Object(u["c"])(n).then((function(e){t.$message({message:"分配成功",type:"success",duration:2500}),t.$router.back()}))},handleClear:function(){this.allResourceCate.forEach((function(t){t.checked=!1})),this.allResource.forEach((function(t){t.checked=!1})),this.$forceUpdate()},checkAll:function(t){for(var e=this.getResourceByCate(t.id),n=0;n<e.length;n++)e[n].checked=t.checked;this.$forceUpdate()},handleCheckChange:function(t){var e=this;this.allResourceCate.forEach((function(n){n.id===t.parentId&&(n.checked=e.isAllChecked(t.parentId))})),this.$forceUpdate()}}},a=o,l=(n("18a1"),n("2877")),i=Object(l["a"])(a,r,c,!1,null,"47b78cfe",null);e["default"]=i.exports},d0fe:function(t,e,n){}}]);